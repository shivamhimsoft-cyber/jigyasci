{% extends "frontBase.html" %}
{% block title %}Contact | JigyaSci{% endblock %}
{% block nav_bar_width %}lg:w-[60%] md:w-[90%] w-full lg:py-6 md:py-6 py-2{% endblock %}
{% block footer_width %}lg:w-[60%] md:w-[90%] w-full{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <!-- Hero Section -->
    <div class="text-center mb-16">
        <h1 class="text-5xl font-bold text-gray-900 mb-4">Get in <span class="text-teal-600">Touch</span></h1>
        <div class="w-32 h-1.5 bg-gradient-to-r from-teal-600 to-gray-900 mx-auto mb-6 rounded-full"></div>
        <p class="text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed">
            Have questions or wish to collaborate? Our team is ready to assist. Reach out, and weâ€™ll respond promptly with professional support.
        </p>
    </div>

    <!-- Main Content -->
    <div class="grid lg:grid-cols-2 gap-12 items-start">
        <!-- Contact Form -->
        <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100 transition-all duration-300 hover:shadow-3xl">
            <div class="p-10">
                <div class="flex items-center mb-8">
                    <div class="bg-teal-600 p-3 rounded-lg mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                    </div>
                    <h2 class="text-3xl font-semibold text-gray-900">Send Us a Message</h2>
                </div>

                <!-- Flash Messages (Fallback) -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="bg-{{ 'green-100' if category == 'success' else 'yellow-100' if category == 'warning' else 'red-100' }} border-{{ 'green-300' if category == 'success' else 'yellow-300' if category == 'warning' else 'red-300' }} text-{{ 'green-800' if category == 'success' else 'yellow-800' if category == 'warning' else 'red-800' }} p-4 rounded-lg mb-4">
                                {{ message }}
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <!-- Contact Form -->
                <form id="contactForm" class="space-y-6">
                    {{ form.hidden_tag() }}
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                            <div class="relative">
                                {{ form.name(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-600 focus:border-transparent transition-all duration-300", id="name", required="true") }}
                                {% if form.name.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.name.errors[0] }}</p>
                                {% endif %}
                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                    <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                            <div class="relative">
                                {{ form.email(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-600 focus:border-transparent transition-all duration-300", id="email", required="true") }}
                                {% if form.email.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.email.errors[0] }}</p>
                                {% endif %}
                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                    <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label for="subject" class="block text-sm font-medium text-gray-700 mb-2">Subject *</label>
                        <div class="relative">
                            {{ form.subject(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-600 focus:border-transparent appearance-none transition-all duration-300", id="subject", required="true") }}
                            {% if form.subject.errors %}
                                <p class="text-red-500 text-sm mt-1">{{ form.subject.errors[0] }}</p>
                            {% endif %}
                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4m0 6l-4 4-4-4" />
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-700 mb-2">Your Message *</label>
                        {{ form.message(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-600 focus:border-transparent transition-all duration-300", id="message", rows="6", required="true") }}
                        {% if form.message.errors %}
                            <p class="text-red-500 text-sm mt-1">{{ form.message.errors[0] }}</p>
                        {% endif %}
                    </div>
                    
                    <button type="submit" class="w-full bg-gradient-to-r from-teal-600 to-gray-900 text-white font-semibold px-6 py-4 rounded-lg hover:opacity-90 transition-all duration-300 transform hover:-translate-y-1 shadow-lg flex items-center justify-center">
                        Send Message
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </button>
                </form>
            </div>
        </div>
        
        <!-- Contact Information -->
        <div class="space-y-8">
            <!-- Info Card -->
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100 transition-all duration-300 hover:shadow-3xl">
                <div class="p-10">
                    <div class="flex items-center mb-8">
                        <div class="bg-gray-900 p-3 rounded-lg mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                            </svg>
                        </div>
                        <h2 class="text-3xl font-semibold text-gray-900">Contact Details</h2>
                    </div>
                    
                    <div class="space-y-6">
                        <div class="flex items-start">
                            <div class="bg-gray-100 p-3 rounded-full mr-4 flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-teal-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg text-gray-800 mb-1">Phone</h3>
                                <p class="text-gray-600">+91 0123456789</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="bg-gray-100 p-3 rounded-full mr-4 flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-teal-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg text-gray-800 mb-1">Email</h3>
                                <p class="text-gray-600">support@jigyasci.org</p>
                                <p class="text-gray-600">partnerships@jigyasci.org</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="bg-gray-100 p-3 rounded-full mr-4 flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-teal-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg text-gray-800 mb-1">Headquarters</h3>
                                <p class="text-gray-600">JigyaSci Research Network</p>
                                <p class="text-gray-600">Innovation Tower, Mohali Punjab</p>
                                <!-- <p class="text-gray-600">Noida, Uttar Pradesh 201309</p> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Map Card -->
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100 transition-all duration-300 hover:shadow-3xl">
                <div class="p-10">
                    <div class="flex items-center mb-8">
                        <div class="bg-gray-900 p-3 rounded-lg mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                        </div>
                        <h2 class="text-3xl font-semibold text-gray-900">Our Location</h2>
                    </div>
                    
                    <div class="aspect-w-16 aspect-h-9 rounded-lg overflow-hidden">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3502.566107822643!2d77.3690143150821!3d28.62644408242488!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x390ce534c148b3e3%3A0x1a5e0e8b7c5d4e1f!2sInnovation%20Tower!5e0!3m2!1sen!2sin!4v1620000000000!5m2!1sen!2sin" 
                                width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Success Popup Modal -->
<div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-2xl transform transition-all duration-300 scale-95 hover:scale-100">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-semibold text-gray-900">Message Sent</h3>
            <button id="closeModal" class="text-gray-500 hover:text-gray-700 focus:outline-none">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <p id="modalMessage" class="text-gray-600 mb-4">Your message has been successfully sent. A confirmation email has been dispatched to your inbox.</p>
        <button id="confirmModal" class="w-full bg-teal-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors duration-300">
            OK
        </button>
    </div>
</div>

<!-- JavaScript for Form Submission and Popup -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('contactForm');
        const successModal = document.getElementById('successModal');
        const closeModal = document.getElementById('closeModal');
        const confirmModal = document.getElementById('confirmModal');
        const modalMessage = document.getElementById('modalMessage');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const submitButton = form.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="ti ti-loader-2 animate-spin text-white"></i> Sending...';

            try {
                const response = await fetch('{{ url_for("contact.contact") }}', {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();

                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonText;

                if (data.success) {
                    modalMessage.textContent = data.message;
                    successModal.classList.remove('hidden');
                    // Clear form fields
                    form.reset();
                } else {
                    alert(data.message); // Fallback for errors
                }
            } catch (error) {
                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonText;
                alert('An error occurred. Please try again later.');
                console.error('Error:', error);
            }
        });

        closeModal.addEventListener('click', () => {
            successModal.classList.add('hidden');
        });

        confirmModal.addEventListener('click', () => {
            successModal.classList.add('hidden');
        });

        // Close modal on outside click
        window.addEventListener('click', (e) => {
            if (e.target === successModal) {
                successModal.classList.add('hidden');
            }
        });
    });
</script>

<!-- Styles -->
<style>
    .animate-spin {
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }
    .hover:shadow-3xl {
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    #successModal .hover:scale-100 {
        transition: transform 0.3s ease;
    }
    #successModal .scale-95 {
        transform: scale(0.95);
    }
</style>
{% endblock %}
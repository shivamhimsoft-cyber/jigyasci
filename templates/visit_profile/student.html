{% extends "frontBase.html" %}

{% block title %}Research Collaboration Platform | {{ student.name }}{% endblock %}

{% block navbar_extra_profile %}
<div><img src="../static/images/logo-shade_blue.png" class="lg:h-[60px] md:h-[60px] h-[50px] w-auto " alt=""></div>
{% endblock %}

{% block nav_bar_width %}
lg:w-[70%] md:w-[90%] w-full py-2
{% endblock %}
{% block footer_width %}
lg:w-[70%] md:w-[90%] w-full
{% endblock %}

{% block content %}
<style>
.bookmark-btn {
    transition: all 0.2s ease;
    z-index: 10;
}

.bookmark-btn.bookmarked i {
    color: #f59e0b !important; /* yellow-500 */
}

.bookmark-btn:hover {
    transform: scale(1.1);
}

/* Animation for bookmark icon */
@keyframes bounce {
    0%, 20%, 53%, 80%, 100% {
        transform: translate3d(0, 0, 0);
    }
    40%, 43% {
        transform: translate3d(0, -8px, 0);
    }
    70% {
        transform: translate3d(0, -4px, 0);
    }
    90% {
        transform: translate3d(0, -2px, 0);
    }
}

.bookmark-btn.bookmarked i {
    animation: bounce 0.5s;
}

/* Ensure bookmarked state is visible even without hover */
.bookmarked {
    opacity: 1 !important;
}
</style>

<div class="w-full flex justify-center p-4 min-h-screen">
    <div class="lg:w-[70%] md:w-[90%] w-full">
        <div class="p-4 flex lg:flex-row md:flex-row flex-col-reverse bg-white">
            <div class="w-full grid lg:grid-cols-4 md:grid-cols-3 grid-cols-1 gap-4">
                <!-- Left Sidebar with Tabs -->
                <div class="w-full bg-white">
                    <div class="bg-white sticky top-20">
                        <a href="#tab-content-studentProfile">
                            <button class="w-full h-max text-left rounded-sm px-4 py-2 whitespace-nowrap bg-secondary text-white font-semibold border-t-[1px] hover:border-t-gray-100 hover:text-white hover:bg-secondary transition ease-in duration-2000">
                                <i class="fa fa-user text-sm mr-2"></i> Profile
                            </button>
                        </a>
                        <a href="#tab-content-skills">
                            <button class="w-full h-max text-left rounded-sm px-4 py-2 whitespace-nowrap text-secondary font-semibold border-t-[1px] hover:border-t-gray-100 hover:text-white hover:bg-secondary transition ease-in duration-2000">
                                <i class="fa fa-lightbulb text-sm mr-2"></i> Skills
                            </button>
                        </a>
                        <a href="#tab-content-studentTeam">
                            <button class="w-full h-max text-left rounded-sm px-4 py-2 whitespace-nowrap text-secondary font-semibold border-t-[1px] hover:border-t-gray-100 hover:text-white hover:bg-secondary transition ease-in duration-2000">
                                <i class="fa fa-users text-sm mr-2"></i> My Team
                            </button>
                        </a>
                        <a href="#tab-content-studentAward">
                            <button class="w-full h-max text-left rounded-sm px-4 py-2 whitespace-nowrap text-secondary font-semibold border-t-[1px] hover:border-t-gray-100 hover:text-white hover:bg-secondary transition ease-in duration-2000">
                                <i class="fa fa-award text-sm mr-2"></i> Awards & Recognition
                            </button>
                        </a>
                    </div>

                    <!-- Latest Publication Section -->
                    <div class="bg-white rounded-sm shadow-sm overflow-hidden mb-6 mt-6 border-[1px] border-gray-300">
                        <div class="bg-secondary px-3 py-2 text-white font-medium flex items-center">
                            <i class="fas fa-newspaper mr-2"></i>
                            <span>Latest Publication</span>
                        </div>
                        <div class="p-4">
                            {% if publications and publications|length > 0 %}
                                {% set latest_pub = publications[0] %}
                                <h4 class="font-bold text-gray-800 text-sm mb-1">"{{ latest_pub.title }}"</h4>
                                <p class="text-gray-600 text-xs mb-2">{{ latest_pub.journal_or_conference }} ({{ latest_pub.year }})</p>
                                <div class="flex justify-between items-center">
                                    <span class="text-xs text-gray-500">Published: {{ latest_pub.date.strftime('%b %Y') if latest_pub.date else 'N/A' }}</span>
                                    {% if latest_pub.doi %}
                                    <a href="{{ latest_pub.doi }}" class="text-secondary text-xs font-medium hover:underline flex items-center">
                                        View <i class="fas fa-external-link-alt ml-1 text-xs"></i>
                                    </a>
                                    {% endif %}
                                </div>
                            {% else %}
                                <p class="text-gray-500 text-sm">No publications available</p>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Similar Researchers Section -->
                    <div class="bg-white rounded-lg shadow-sm overflow-hidden mb-6 border-[1px] border-gray-300">
                        <div class="bg-secondary px-3 py-2 text-white font-medium flex items-center">
                            <i class="fas fa-users mr-2"></i>
                            <span>Similar Researchers</span>
                        </div>
                        <div class="divide-y divide-gray-100">
                            <a href="#" class="group block p-3 hover:bg-gray-50 transition-colors">
                                <div class="flex items-center">
                                    <img src="../static/images/profile.png" class="h-10 w-10 rounded-full mr-3" alt="">
                                    <div>
                                        <h4 class="font-bold text-gray-800 text-sm group-hover:text-secondary">Rahul Sharma</h4>
                                        <p class="text-gray-600 text-xs">Computer Science, IIT Bombay</p>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="group block p-3 hover:bg-gray-50 transition-colors">
                                <div class="flex items-center">
                                    <img src="../static/images/profile.png" class="h-10 w-10 rounded-full mr-3" alt="">
                                    <div>
                                        <h4 class="font-bold text-gray-800 text-sm group-hover:text-secondary">Priya Patel</h4>
                                        <p class="text-gray-600 text-xs">Biotech, IISc Bangalore</p>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="group block p-3 hover:bg-gray-50 transition-colors">
                                <div class="flex items-center">
                                    <img src="../static/images/profile.png" class="h-10 w-10 rounded-full mr-3" alt="">
                                    <div>
                                        <h4 class="font-bold text-gray-800 text-sm group-hover:text-secondary">Amit Kumar</h4>
                                        <p class="text-gray-600 text-xs">Electrical Engg, IIT Delhi</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="w-full lg:col-span-3 md:col-span-2 col-span-1">
                    <!-- Profile Tab Content -->
                    <div id="tab-content-studentProfile" data-tab-content="studentProfile" class="student-tab-content w-full">
                        <!-- Profile Header with Card Layout -->
                        <div class="bg-white rounded-xl shadow-md overflow-hidden mb-6">
                            <div class="md:flex">
                                <!-- Profile Image Section -->
                                <div class="md:w-1/4 p-6 flex flex-col items-center bg-secondary">
                                    <div class="w-40 h-40 rounded-full border-4 border-white shadow-lg overflow-hidden mb-4">
                                        <img src="{{ url_for('static', filename=student.profile_picture) if student.profile_picture else url_for('static', filename='images/profile.png') }}" class="w-full h-full object-cover" alt="{{ student.name }}">
                                    </div>
                                    <h1 class="text-white font-bold text-xl mb-1">{{ student.name }}</h1>
                                    <p class="text-white/90 text-sm mb-2">{{ student.current_status or 'Research Scholar' }}</p>
                                    <p class="text-white/80 text-xs text-center mb-4">{{ student.affiliation or 'University' }}</p>

                                    <!-- Social Links -->
                                    <div class="flex space-x-3 mb-4">
                                        <a href="#" class="text-white hover:text-gray-200 transition-colors">
                                            <i class="fab fa-linkedin fa-lg"></i>
                                        </a>
                                        <a href="#" class="text-white hover:text-gray-200 transition-colors">
                                            <i class="fab fa-researchgate fa-lg"></i>
                                        </a>
                                        <a href="#" class="text-white hover:text-gray-200 transition-colors">
                                            <i class="fab fa-google fa-lg"></i>
                                        </a>
                                        <a href="#" class="text-white hover:text-gray-200 transition-colors">
                                            <i class="fas fa-envelope fa-lg"></i>
                                        </a>
                                    </div>

                                    <!-- Quick Stats -->
                                    <div class="w-full bg-white/20 rounded-lg p-3">
                                        <div class="flex justify-between text-center">
                                            <div>
                                                <div class="text-white font-bold text-lg">{{ publications|length }}</div>
                                                <div class="text-white/80 text-xs">Publications</div>
                                            </div>
                                            <div class="border-l border-white/30"></div>
                                            <div>
                                                <div class="text-white font-bold text-lg">{{ experiences|length }}</div>
                                                <div class="text-white/80 text-xs">Projects</div>
                                            </div>
                                            <div class="border-l border-white/30"></div>
                                            <div>
                                                <div class="text-white font-bold text-lg">{{ skills|length }}</div>
                                                <div class="text-white/80 text-xs">Skills</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Profile Details Section -->
                                <div class="md:w-3/4 p-6">
                                    <!-- Contact Information -->
                                    <div class="mb-6 relative">
                                        <h2 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                                            <i class="fas fa-address-card text-secondary mr-2"></i>
                                            Contact Information
                                        </h2>
                                        {% if current_user.is_authenticated %}
                                            <button class="bookmark-btn absolute top-3 right-3 p-2 rounded-full hover:bg-yellow-50 transition-colors"
                                                    data-type="student"
                                                    data-id="{{ student.id }}"
                                                    title="Bookmark this student">
                                                <i class="far fa-bookmark text-gray-400 text-xl"></i>
                                            </button>
                                        {% else %}
                                            <a href="{{ url_for('auth.login') }}"
                                               class="absolute top-3 right-3 p-2 rounded-full bg-white/80 border border-gray-200 
                                                      hover:bg-primary hover:text-secondary hover:border-primary 
                                                      transition-all duration-300 shadow-sm z-10 group"
                                               title="Login to bookmark this profile">
                                                <i class="far fa-bookmark text-gray-400 text-lg"></i>
                                                <span class="absolute -top-1 -right-1 flex items-center justify-center w-4 h-4 
                                                              rounded-full bg-white border border-gray-300 shadow group-hover:bg-secondary">
                                                    <i class="fas fa-lock text-[10px] text-gray-600 group-hover:text-white"></i>
                                                </span>
                                            </a>
                                        {% endif %}
                                        <div class="grid md:grid-cols-2 gap-3">
                                            <div class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                                <div class="bg-secondary/10 p-2 rounded-full mr-3">
                                                    <i class="fas fa-envelope text-secondary"></i>
                                                </div>
                                                <div>
                                                    <p class="text-xs text-gray-500">Email</p>
                                                    <p class="text-sm font-medium">{{ student.contact_email or 'Not provided' }}</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                                <div class="bg-secondary/10 p-2 rounded-full mr-3">
                                                    <i class="fas fa-phone text-secondary"></i>
                                                </div>
                                                <div>
                                                    <p class="text-xs text-gray-500">Phone</p>
                                                    <p class="text-sm font-medium">{{ student.contact_phone or 'Not provided' }}</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                                <div class="bg-secondary/10 p-2 rounded-full mr-3">
                                                    <i class="fas fa-map-marker-alt text-secondary"></i>
                                                </div>
                                                <div>
                                                    <p class="text-xs text-gray-500">Address</p>
                                                    <p class="text-sm font-medium">{{ student.address or 'Not provided' }}</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                                <div class="bg-secondary/10 p-2 rounded-full mr-3">
                                                    <i class="fas fa-globe text-secondary"></i>
                                                </div>
                                                <div>
                                                    <p class="text-xs text-gray-500">Website</p>
                                                    <p class="text-sm font-medium">{{ student.website or 'Not provided' }}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Research Interests -->
                                    <div class="mb-6">
                                        <h2 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                                            <i class="fas fa-search text-secondary mr-2"></i>
                                            Research Interests
                                        </h2>
                                        <div class="flex flex-wrap gap-2">
                                            {% if student.research_interests %}
                                                {% for interest in student.research_interests.split(',') %}
                                                    <span class="inline-flex items-center px-3 py-1 rounded-full bg-secondary/10 text-secondary text-sm font-medium">
                                                        {{ interest.strip() }}
                                                    </span>
                                                {% endfor %}
                                            {% else %}
                                                <p class="text-gray-500">No research interests specified</p>
                                            {% endif %}
                                        </div>
                                    </div>

                                    <!-- About Me -->
                                    <div>
                                        <h2 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                                            <i class="fas fa-user-graduate text-secondary mr-2"></i>
                                            About Me
                                        </h2>
                                        <p class="text-gray-700 text-sm leading-relaxed">
                                            {{ student.why_me or 'No description provided.' }}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Education Section -->
                        <div class="bg-white rounded-xl border-[1px] border-gray-400 shadow-md overflow-hidden mb-6">
                            <div class="p-6">
                                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-graduation-cap text-secondary mr-2"></i>
                                    Education
                                </h2>

                                <div class="space-y-4">
                                    {% for education in educations %}
                                        <div class="flex items-start group hover:bg-gray-50 p-3 rounded-lg transition-colors duration-200 relative">
                                            <div class="bg-secondary/10 p-3 rounded-full mr-4 mt-1">
                                                <i class="fas fa-university text-secondary"></i>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex justify-between items-start">
                                                    <h3 class="font-bold text-gray-800">{{ education.degree_name }}</h3>
                                                    <div class="flex items-center">
                                                        <span class="bg-secondary/10 text-secondary text-xs px-2 py-1 rounded-full mr-2">
                                                            {% if education.currently_pursuing %}
                                                                {{ education.start_year }} - Present
                                                            {% else %}
                                                                {{ education.start_year }} - {{ education.end_year }}
                                                            {% endif %}
                                                        </span>
                                                        {% if current_user.is_authenticated %}
                                                            <button class="bookmark-btn p-1.5 rounded-full hover:bg-yellow-50 transition-colors"
                                                                    data-type="education"
                                                                    data-id="{{ education.id }}"
                                                                    title="Bookmark this education">
                                                                <i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>
                                                            </button>
                                                        {% else %}
                                                            <a href="{{ url_for('auth.login') }}"
                                                               class="p-2 rounded-full bg-white/80 border border-gray-200 
                                                                      hover:bg-primary hover:text-secondary hover:border-primary 
                                                                      transition-all duration-300 shadow-sm z-10 group"
                                                               title="Login to bookmark this education">
                                                                <i class="far fa-bookmark text-gray-400 text-lg"></i>
                                                                <span class="absolute -top-1 -right-1 flex items-center justify-center w-4 h-4 
                                                                              rounded-full bg-white border border-gray-300 shadow group-hover:bg-secondary">
                                                                    <i class="fas fa-lock text-[10px] text-gray-600 group-hover:text-white"></i>
                                                                </span>
                                                            </a>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                                <p class="text-gray-600 text-sm mb-1">{{ education.college }}, {{ education.university }}</p>
                                                {% if education.university_address %}
                                                    <p class="text-gray-700 text-sm italic">{{ education.university_address }}</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    {% else %}
                                        <p class="text-gray-500">No education information available</p>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <!-- Experience & Publications Grid -->
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- Experience Section -->
                            <div class="bg-white rounded-xl shadow-md overflow-hidden">
                                <div class="p-6">
                                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                        <i class="fas fa-briefcase text-secondary mr-2"></i>
                                        Experience
                                    </h2>

                                    <div class="space-y-4">
                                        {% for experience in experiences %}
                                            <div class="border-l-4 border-secondary pl-4 group hover:bg-gray-50 p-3 rounded-lg transition-colors relative">
                                                {% if current_user.is_authenticated %}
                                                    <button class="bookmark-btn absolute top-3 right-3 p-1.5 rounded-full hover:bg-yellow-50 transition-colors"
                                                            data-type="experience"
                                                            data-id="{{ experience.id }}"
                                                            title="Bookmark this experience">
                                                        <i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>
                                                    </button>
                                                {% else %}
                                                    <a href="{{ url_for('auth.login') }}"
                                                       class="absolute top-3 right-3 p-2 rounded-full bg-white/80 border border-gray-200 
                                                              hover:bg-primary hover:text-secondary hover:border-primary 
                                                              transition-all duration-300 shadow-sm z-10 group"
                                                       title="Login to bookmark this experience">
                                                        <i class="far fa-bookmark text-gray-400 text-lg"></i>
                                                        <span class="absolute -top-1 -right-1 flex items-center justify-center w-4 h-4 
                                                                      rounded-full bg-white border border-gray-300 shadow group-hover:bg-secondary">
                                                            <i class="fas fa-lock text-[10px] text-gray-600 group-hover:text-white"></i>
                                                        </span>
                                                    </a>
                                                {% endif %}
                                                <div class="flex justify-between items-start">
                                                    <h3 class="font-bold text-gray-800">{{ experience.position }}</h3>
                                                    <span class="bg-secondary/10 text-secondary text-xs px-2 py-1 rounded-full">
                                                        {% if experience.currently_working %}
                                                            {{ experience.start_date.strftime('%b %Y') }} - Present
                                                        {% else %}
                                                            {{ experience.start_date.strftime('%b %Y') }} - {{ experience.end_date.strftime('%b %Y') }}
                                                        {% endif %}
                                                    </span>
                                                </div>
                                                <p class="text-gray-600 text-sm mb-2">{{ experience.project_title }}</p>
                                                <ul class="list-disc list-inside text-gray-700 text-sm space-y-1 ml-2">
                                                    {% if experience.pi %}
                                                        <li>PI: {{ experience.pi }} ({{ experience.pi_affiliation }})</li>
                                                    {% endif %}
                                                    <li>At: {{ experience.college }}, {{ experience.university_or_industry }}</li>
                                                </ul>
                                            </div>
                                        {% else %}
                                            <p class="text-gray-500">No experience information available</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>

                            <!-- Publications Section -->
                            <div class="bg-white rounded-xl shadow-md overflow-hidden">
                                <div class="p-6">
                                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                        <i class="fas fa-file-alt text-secondary mr-2"></i>
                                        Selected Publications
                                    </h2>

                                    <div class="space-y-4">
                                        {% for publication in publications[:2] %}
                                            <div class="border rounded-lg p-4 hover:shadow-md transition-shadow group relative">
                                                {% if current_user.is_authenticated %}
                                                    <button class="bookmark-btn absolute top-3 right-3 p-1.5 rounded-full hover:bg-yellow-50 transition-colors"
                                                            data-type="publication"
                                                            data-id="{{ publication.id }}"
                                                            title="Bookmark this publication">
                                                        <i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>
                                                    </button>
                                                {% else %}
                                                    <a href="{{ url_for('auth.login') }}"
                                                       class="absolute top-3 right-3 p-2 rounded-full bg-white/80 border border-gray-200 
                                                              hover:bg-primary hover:text-secondary hover:border-primary 
                                                              transition-all duration-300 shadow-sm z-10 group"
                                                       title="Login to bookmark this publication">
                                                        <i class="far fa-bookmark text-gray-400 text-lg"></i>
                                                        <span class="absolute -top-1 -right-1 flex items-center justify-center w-4 h-4 
                                                                      rounded-full bg-white border border-gray-300 shadow group-hover:bg-secondary">
                                                            <i class="fas fa-lock text-[10px] text-gray-600 group-hover:text-white"></i>
                                                        </span>
                                                    </a>
                                                {% endif %}
                                                <h3 class="font-bold text-gray-800 group-hover:text-secondary transition-colors">
                                                    "{{ publication.title }}"
                                                </h3>
                                                <p class="text-gray-600 text-sm mb-1">{{ publication.journal_or_conference }} ({{ publication.year }})</p>
                                                <p class="text-gray-700 text-sm mb-2">
                                                    {{ publication.abstract[:150] }}...
                                                </p>
                                                <div class="flex space-x-3">
                                                    {% if publication.doi %}
                                                        <a href="https://doi.org/{{ publication.doi }}" target="_blank" class="text-secondary text-sm flex items-center hover:underline">
                                                            <i class="fas fa-external-link-alt mr-1 text-xs"></i> View
                                                        </a>
                                                    {% endif %}
                                                    <a href="#" class="text-secondary text-sm flex items-center hover:underline">
                                                        <i class="fas fa-file-pdf mr-1 text-xs"></i> PDF
                                                    </a>
                                                    <a href="#" class="text-secondary text-sm flex items-center hover:underline">
                                                        <i class="fas fa-quote-right mr-1 text-xs"></i> Cite
                                                    </a>
                                                </div>
                                            </div>
                                        {% else %}
                                            <p class="text-gray-500">No publications available</p>
                                        {% endfor %}
                                        {% if publications|length > 2 %}
                                            <div class="pt-2">
                                                <button class="flex items-center text-secondary font-medium hover:text-secondary-dark transition-colors">
                                                    <i class="fas fa-list mr-2"></i> View All {{ publications|length }} Publications
                                                </button>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Skills Tab Content -->
                    <div id="tab-content-skills" data-tab-content="skills" class="student-tab-content w-full hidden">
                        <div class="bg-white rounded-xl border-[1px] border-gray-400 shadow-md overflow-hidden mb-6">
                            <div class="p-6">
                                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-tools text-secondary mr-2"></i>
                                    Skills
                                </h2>

                                <div class="grid md:grid-cols-2 gap-4">
                                    {% for skill in skills %}
                                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow group relative">
                                            {% if current_user.is_authenticated %}
                                                <button class="bookmark-btn absolute top-3 right-3 p-1.5 rounded-full hover:bg-yellow-50 transition-colors"
                                                        data-type="skill"
                                                        data-id="{{ skill.id }}"
                                                        title="Bookmark this skill">
                                                    <i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>
                                                </button>
                                            {% else %}
                                                <a href="{{ url_for('auth.login') }}"
                                                   class="absolute top-3 right-3 p-2 rounded-full bg-white/80 border border-gray-200 
                                                          hover:bg-primary hover:text-secondary hover:border-primary 
                                                          transition-all duration-300 shadow-sm z-10 group"
                                                   title="Login to bookmark this skill">
                                                    <i class="far fa-bookmark text-gray-400 text-lg"></i>
                                                    <span class="absolute -top-1 -right-1 flex items-center justify-center w-4 h-4 
                                                                  rounded-full bg-white border border-gray-300 shadow group-hover:bg-secondary">
                                                        <i class="fas fa-lock text-[10px] text-gray-600 group-hover:text-white"></i>
                                                    </span>
                                                </a>
                                            {% endif %}
                                            <div class="flex justify-between items-center">
                                                <div>
                                                    <h4 class="font-bold text-gray-800">{{ skill.skill_name }}</h4>
                                                    <p class="text-sm text-gray-600">{{ skill.skill_type }}</p>
                                                </div>
                                                <span class="text-sm font-medium bg-secondary/10 text-secondary px-2 py-1 rounded-full">
                                                    {{ skill.proficiency_level }}
                                                </span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                                <div class="bg-secondary h-2 rounded-full" 
                                                     style="width: {% if skill.proficiency_level == 'Beginner' %}25%{% elif skill.proficiency_level == 'Intermediate' %}50%{% elif skill.proficiency_level == 'Advanced' %}75%{% else %}100%{% endif %}">
                                                </div>
                                            </div>
                                        </div>
                                    {% else %}
                                        <p class="text-gray-500 col-span-2">No skills listed</p>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- My Team Tab Content -->
                    <div id="tab-content-studentTeam" data-tab-content="studentTeam" class="student-tab-content w-full hidden">
                        <div class="bg-white rounded-xl border-[1px] border-gray-400 shadow-md overflow-hidden mb-6">
                            <div class="p-6">
                                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-users text-secondary mr-2"></i>
                                    Research Team
                                </h2>

                                <div class="grid md:grid-cols-2 gap-4">
                                    {% for membership in team_memberships %}
                                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow group relative">
                                            {% if current_user.is_authenticated %}
                                                <button class="bookmark-btn absolute top-3 right-3 p-1.5 rounded-full hover:bg-yellow-50 transition-colors"
                                                        data-type="team"
                                                        data-id="{{ membership.id }}"
                                                        title="Bookmark this team membership">
                                                    <i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>
                                                </button>
                                            {% else %}
                                                <a href="{{ url_for('auth.login') }}"
                                                   class="absolute top-3 right-3 p-2 rounded-full bg-white/80 border border-gray-200 
                                                          hover:bg-primary hover:text-secondary hover:border-primary 
                                                          transition-all duration-300 shadow-sm z-10 group"
                                                   title="Login to bookmark this team membership">
                                                    <i class="far fa-bookmark text-gray-400 text-lg"></i>
                                                    <span class="absolute -top-1 -right-1 flex items-center justify-center w-4 h-4 
                                                                  rounded-full bg-white border border-gray-300 shadow group-hover:bg-secondary">
                                                        <i class="fas fa-lock text-[10px] text-gray-600 group-hover:text-white"></i>
                                                    </span>
                                                </a>
                                            {% endif %}
                                            <div class="flex items-center gap-4">
                                                <div class="relative">
                                                    <img src="{{ url_for('static', filename='images/logo-shade_blue.png') }}" class="w-16 h-16 rounded-full border-2 border-secondary/30" alt="">
                                                    <div class="absolute -bottom-1 -right-1 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded-full">
                                                        {{ membership.pi_profile.profile.user.user_type }}
                                                    </div>
                                                </div>
                                                <div class="flex-1">
                                                    <h5 class="font-bold">{{ membership.pi_profile.name }}</h5>
                                                    <p class="text-sm text-gray-600">{{ membership.pi_profile.department }}, {{ membership.pi_profile.affiliation }}</p>
                                                    <p class="text-xs text-secondary-dark font-medium">{{ membership.position }}</p>
                                                    <div class="flex items-center mt-1">
                                                        <span class="text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded mr-2">{{ membership.status }}</span>
                                                        <span class="text-xs text-gray-500">
                                                            {{ membership.start_date.strftime('%b %Y') }} -
                                                            {% if membership.end_date %}
                                                                {{ membership.end_date.strftime('%b %Y') }}
                                                            {% else %}
                                                                Present
                                                            {% endif %}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% else %}
                                        <p class="text-gray-500 col-span-2">No team memberships found</p>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Awards & Recognition Tab Content -->
                    <div id="tab-content-studentAward" data-tab-content="studentAward" class="student-tab-content w-full hidden">
                        <div class="bg-white rounded-xl border-[1px] border-gray-400 shadow-md overflow-hidden mb-6">
                            <div class="p-6">
                                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-trophy text-secondary mr-2"></i>
                                    Awards & Recognition
                                </h2>

                                <div class="grid md:grid-cols-2 gap-4">
                                    {% for award in awards %}
                                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow group relative">
                                            {% if current_user.is_authenticated %}
                                                <button class="bookmark-btn absolute top-3 right-3 p-1.5 rounded-full hover:bg-yellow-50 transition-colors"
                                                        data-type="award"
                                                        data-id="{{ award.id }}"
                                                        title="Bookmark this award">
                                                    <i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>
                                                </button>
                                            {% else %}
                                                <a href="{{ url_for('auth.login') }}"
                                                   class="absolute top-3 right-3 p-2 rounded-full bg-white/80 border border-gray-200 
                                                          hover:bg-primary hover:text-secondary hover:border-primary 
                                                          transition-all duration-300 shadow-sm z-10 group"
                                                   title="Login to bookmark this award">
                                                    <i class="far fa-bookmark text-gray-400 text-lg"></i>
                                                    <span class="absolute -top-1 -right-1 flex items-center justify-center w-4 h-4 
                                                                  rounded-full bg-white border border-gray-300 shadow group-hover:bg-secondary">
                                                        <i class="fas fa-lock text-[10px] text-gray-600 group-hover:text-white"></i>
                                                    </span>
                                                </a>
                                            {% endif %}
                                            <div class="text-yellow-500 text-4xl mb-2">
                                                <i class="fas fa-award"></i>
                                            </div>
                                            <h3 class="font-bold text-gray-800">{{ award.title }}</h3>
                                            <p class="text-sm text-gray-600">{{ award.issuing_organization }}</p>
                                            <p class="text-xs text-gray-500 mt-2">
                                                <i class="fas fa-calendar mr-1"></i>
                                                {{ award.date.strftime('%b %Y') }}
                                            </p>
                                            {% if award.description %}
                                                <p class="text-sm text-gray-700 mt-2">{{ award.description }}</p>
                                            {% endif %}
                                            {% if award.document_link %}
                                                <a href="{{ award.document_link }}" class="text-secondary text-sm font-medium hover:underline flex items-center mt-2">
                                                    View Certificate <i class="fas fa-external-link-alt ml-1 text-xs"></i>
                                                </a>
                                            {% endif %}
                                        </div>
                                    {% else %}
                                        <p class="text-gray-500 col-span-2">No awards or recognitions listed</p>
                                    {% endfor %}
                                </div>
                                {% if awards|length > 4 %}
                                    <div class="flex justify-center mt-6">
                                        <button class="px-4 py-2 bg-secondary text-white rounded-lg hover:bg-secondary-dark transition-colors">
                                            View All {{ awards|length }} Awards
                                        </button>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Tab functionality
    const tabContents = document.querySelectorAll('.student-tab-content');
    
    // Show the first tab content by default
    if (tabContents.length > 0) {
        tabContents[0].classList.remove('hidden');
    }

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            
            if (targetElement) {
                // Hide all tab contents first
                document.querySelectorAll('.student-tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                // Show the target tab content
                targetElement.classList.remove('hidden');
                
                // Scroll to the target
                targetElement.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        });
    });

    // Check bookmark status for all items
    function checkAllBookmarkStatuses() {
        {% if current_user.is_authenticated %}
            // Check student profile bookmark
            const studentBookmarkBtn = document.querySelector('.bookmark-btn[data-type="student"]');
            if (studentBookmarkBtn) {
                const bookmarkType = studentBookmarkBtn.dataset.type;
                const itemId = studentBookmarkBtn.dataset.id;
                
                fetch(`/bookmark/status/${bookmarkType}/${itemId}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.bookmarked) {
                            studentBookmarkBtn.innerHTML = '<i class="fas fa-bookmark text-yellow-500 text-xl"></i>';
                            studentBookmarkBtn.classList.add('bookmarked');
                        } else {
                            studentBookmarkBtn.innerHTML = '<i class="far fa-bookmark text-gray-400 text-xl"></i>';
                            studentBookmarkBtn.classList.remove('bookmarked');
                        }
                    })
                    .catch(error => {
                        console.error('Error checking student bookmark status:', error);
                    });
            }
            
            // Check other bookmarks
            document.querySelectorAll('.bookmark-btn:not([data-type="student"])').forEach(button => {
                const bookmarkType = button.dataset.type;
                const itemId = button.dataset.id;
                
                fetch(`/bookmark/status/${bookmarkType}/${itemId}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.bookmarked) {
                            button.innerHTML = '<i class="fas fa-bookmark text-yellow-500 text-lg"></i>';
                            button.classList.add('bookmarked');
                        } else {
                            button.innerHTML = '<i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>';
                            button.classList.remove('bookmarked');
                        }
                    })
                    .catch(error => {
                        console.error('Error checking bookmark status:', error);
                    });
            });
        {% endif %}
    }

    // Check all bookmark statuses on page load
    checkAllBookmarkStatuses();

    // Bookmark toggle functionality
    document.querySelectorAll('.bookmark-btn').forEach(button => {
        button.addEventListener('click', function() {
            const bookmarkType = this.dataset.type;
            const itemId = this.dataset.id;
            
            fetch(`/bookmark/${bookmarkType}/${itemId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    if (data.bookmarked) {
                        if (bookmarkType === 'student') {
                            this.innerHTML = '<i class="fas fa-bookmark text-yellow-500 text-xl"></i>';
                        } else {
                            this.innerHTML = '<i class="fas fa-bookmark text-yellow-500 text-lg"></i>';
                        }
                        this.classList.add('bookmarked');
                        showNotification('Bookmark added!', 'success');
                    } else {
                        if (bookmarkType === 'student') {
                            this.innerHTML = '<i class="far fa-bookmark text-gray-400 text-xl"></i>';
                        } else {
                            this.innerHTML = '<i class="far fa-bookmark text-gray-400 hover:text-yellow-500 text-lg"></i>';
                        }
                        this.classList.remove('bookmarked');
                        showNotification('Bookmark removed', 'info');
                    }
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error updating bookmark', 'error');
            });
        });
    });
    
    // Notification function
    function showNotification(message, type) {
        const existingNotification = document.querySelector('.fixed.notification');
        if (existingNotification) {
            document.body.removeChild(existingNotification);
        }
        
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-transform transform translate-x-full notification ${type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500'} text-white`;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.classList.remove('translate-x-full');
            notification.classList.add('translate-x-0');
        }, 10);
        
        setTimeout(() => {
            notification.classList.remove('translate-x-0');
            notification.classList.add('translate-x-full');
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }
});
</script>

{% endblock %}
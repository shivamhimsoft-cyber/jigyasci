{% extends "frontBase.html" %}
{% block title %}Technologies | Full Table{% endblock %}

{% block navbar_extra_profile %}
<div><img src="../static/images/logo-shade_blue.png" class="lg:h-[60px] md:h-[60px] h-[50px] w-auto " alt=""></div>
{% endblock %}
{% block nav_bar_width %}
    w-full py-2
{% endblock %}
{% block footer_width %}
    w-full
{% endblock %}

{% block navbar_extra %}
<form action="{{ url_for('technology.full_table') }}" method="GET" class="flex flex-grow max-w-md w-full">
    <div class="relative w-full">
        <input type="text" name="query" value="{{ query or '' }}" placeholder="Search Technology / Keywords / Industries"
               class="w-full pr-10 px-0 text-secondary border-b-[1px] border-b-secondary/60 border-0 py-0 focus:ring-0 focus:outline-none focus:border-secondary" />
        <button type="submit" class="absolute right-3 top-[50%] translate-y-[-50%] text-secondary hover:scale-105 transition ease-in duration-2000">
            <i class="fa fa-search"></i>
        </button>
    </div>
</form>
{% endblock %}

{% block content %}
<div class="w-full h-full mx-auto px-4 py-8">
    <h1 class="text-2xl font-bold text-secondary mb-6">Technologies - Full View</h1>

    <div class="overflow-x-auto">
        <table class="w-full bg-white border border-gray-200">
            <thead>
                <tr class="bg-secondary">
                    <th class="px-4 py-2 text-white  border-[1px] border-white-gray-100 border-b-black text-[16px] whitespace-nowrap font-normal ">#</th>
                    <th class="px-4 py-2 text-white  border-[1px] border-white-gray-100 border-b-black text-[16px] whitespace-nowrap font-normal ">Title</th>
                    <th class="px-4 py-2 text-white  border-[1px] border-white-gray-100 border-b-black text-[16px] whitespace-nowrap font-normal ">Description</th>
                    <th class="px-4 py-2 text-white  border-[1px] border-white-gray-100 border-b-black text-[16px] whitespace-nowrap font-normal ">Target Industries</th>
                    <!-- <th class="px-4 py-2 text-white  border-[1px] border-white-gray-100 border-b-black text-[16px] whitespace-nowrap font-normal ">Creator</th> -->
                    <th class="px-4 py-2 text-white  border-[1px] border-white-gray-100 border-b-black text-[16px] whitespace-nowrap font-normal ">Action</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                {% for tech in technologies.items %}
                <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-primary/10{% endif %} hover:bg-primary/30">
                    <td class="px-4 py-2 border-[1px] border-black  max-w-[200px] overflow-x-auto font-medium text-[17px]">{{ loop.index + (technologies.page - 1) * technologies.per_page }}</td>
                    <td class="px-4 py-2 border-[1px] border-black  max-w-[200px] overflow-x-auto font-medium text-[17px]">{{ tech.title }}</td>
                    <td class="px-4 py-2 border-[1px] border-black  max-w-[200px] overflow-x-auto font-medium text-[17px]">{{ tech.description|truncate(50) }}</td>
                    <td class="px-4 py-2 border-[1px] border-black  max-w-[200px] overflow-x-auto font-medium text-[17px]">{{ tech.target_industries|truncate(30) }}</td>
                    <!-- <td class="px-4 py-2 border">
                        {% if tech.creator %}
                            {{ tech.creator.name }}
                        {% endif %}
                    </td> -->
                    <td class="px-4 py-2 border-[1px] border-black  max-w-[200px] overflow-x-auto font-medium text-[17px]">
                        {% if tech.creator %}
                            <a href="{{ url_for('faculty_info', profile_id=tech.creator.id) if tech.creator.user.user_type == 'PI'
                                    else url_for('student.student_details', student_id=tech.creator.student_profile.id) if tech.creator.user.user_type == 'Student'
                                    else '#' }}"
                            class="text-white bg-secondary px-3 py-1 rounded hover:bg-primary">
                                View Profile
                            </a>
                        {% endif %}
                    </td>

                </tr>
                {% else %}
                <tr class="bg-primary hover:bg-primary/30">
                    <td colspan="6" class="px-4 py-2 border-[1px] border-black overflow-x-auto font-medium text-[17px]">No technologies found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="flex justify-between items-center mt-6">
        <div class="text-sm text-gray-600">
            Showing {{ technologies.first }} to {{ technologies.last }} of {{ technologies.total }} entries
        </div>
        <div class="flex gap-2">
            {% if technologies.has_prev %}
            <a href="{{ url_for('technology.full_table', page=technologies.prev_num, query=query) }}"
               class="px-3 py-1 border rounded bg-white hover:bg-gray-100">Previous</a>
            {% endif %}

            {% for page_num in technologies.iter_pages(left_edge=2, right_edge=2, left_current=2, right_current=2) %}
                {% if page_num %}
                    {% if page_num == technologies.page %}
                        <span class="px-3 py-1 border rounded bg-secondary text-white">{{ page_num }}</span>
                    {% else %}
                        <a href="{{ url_for('technology.full_table', page=page_num, query=query) }}"
                           class="px-3 py-1 border rounded bg-white hover:bg-gray-100">{{ page_num }}</a>
                    {% endif %}
                {% else %}
                    <span class="px-3 py-1">â€¦</span>
                {% endif %}
            {% endfor %}

            {% if technologies.has_next %}
            <a href="{{ url_for('technology.full_table', page=technologies.next_num, query=query) }}"
               class="px-3 py-1 border rounded bg-white hover:bg-gray-100">Next</a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
